# EndCrystalWM

Shadeable Paper/Bukkit watermark library + optional Gradle bytecode injector.

It broadcasts this message globally in chat every 60 seconds:

`The plugin was generated by EndCrystal AI Â· Upgrade for no watermark & more.`

- `EndCrystal AI` and `Upgrade` are both clickable colored segments.
- `EndCrystal AI` opens `https://endcrystal.ai` with hover text:
  `FREE plugins generator! (Click to open)`.
- `Upgrade` opens `https://endcrystal.ai/upgrade`.

## Compatibility

- Targets Paper/Spigot plugin builds across Java 8 to Java 21.
- Injector patches both `jar` and `shadowJar` outputs.
- Works with `com.github.johnrengelman.shadow`, `io.github.goooler.shadow`, and `com.gradleup.shadow`.

## JitPack Dependency

Use stable Git tags (for example `1.0.1`) instead of moving labels.

```kotlin
repositories {
    maven("https://jitpack.io")
}

dependencies {
    implementation("com.github.weezard12:EndCrystalWM:<version>")
}
```

## No Java/Yml Changes (Buildscript Apply)

Use this when you want the watermark enabled from Gradle only.

```kotlin
buildscript {
    repositories {
        maven("https://jitpack.io")
    }
    dependencies {
        classpath("com.github.weezard12:EndCrystalWM:<version>")
    }
}

plugins {
    java
    id("com.gradleup.shadow") version "9.3.0"
}

apply(plugin = "me.weezard12.endcrystalwm-injector")

repositories {
    mavenCentral()
    maven("https://repo.papermc.io/repository/maven-public/")
    maven("https://jitpack.io")
}

dependencies {
    compileOnly("io.papermc.paper:paper-api:1.21.1-R0.1-SNAPSHOT")
    // runtime watermark dependency is auto-added by the injector plugin by default
}
```

## Plugins DSL Setup (settings.gradle.kts + build.gradle.kts)

If you prefer `plugins {}` for the injector id, add plugin resolution:

```kotlin
// settings.gradle.kts
pluginManagement {
    repositories {
        gradlePluginPortal()
        maven("https://jitpack.io")
    }
    resolutionStrategy {
        eachPlugin {
            if (requested.id.id == "me.weezard12.endcrystalwm-injector") {
                useModule("com.github.weezard12:EndCrystalWM:${requested.version}")
            }
        }
    }
}
```

```kotlin
// build.gradle.kts
plugins {
    java
    id("me.weezard12.endcrystalwm-injector") version "<version>"
    id("com.gradleup.shadow") version "9.3.0"
}
```

The injector patches your plugin main `onEnable()` and inserts:

`EndCrystalWM.installFor(this);`

## Injector Options

```kotlin
endCrystalWmInjector {
    enabled = true
    mainClassOverride.set("com.example.MyPlugin") // optional
    injectorOwnerInternalName.set("my/relocated/path/EndCrystalWM") // optional
    watermarkLanguage.set("en") // optional, e.g. en, es, de, fr, pt-br
    failOnMissingPluginYml.set(true)
    failOnMissingMainClass.set(true)

    // auto dependency wiring defaults:
    autoAddRuntimeDependency.set(true)
    runtimeConfiguration.set("implementation")
    runtimeDependencyNotation.set("com.github.weezard12:EndCrystalWM:<version>")
}
```

You can also set the default language from a Gradle property:

`./gradlew build -PendCrystalWmLanguage=es`

## Runtime Behavior

- When injection is enabled, no host Java/Yml code changes are required.
- The injected call is wrapped in `try/catch Throwable` so host plugin startup is not hard-crashed by missing classes.
- Duplicate injection is skipped automatically.
